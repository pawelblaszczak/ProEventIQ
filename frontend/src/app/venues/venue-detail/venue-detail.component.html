<div *ngIf="loading()" class="loading-container animated-pulse">
  <div class="loading-icon-wrapper">
    <mat-progress-spinner color="primary" mode="indeterminate" diameter="50"></mat-progress-spinner>
  </div>
  <p class="loading-text">{{ 'VENUES.DETAIL.LOADING' | translate }}</p>
  <div class="loading-progress-dots">
    <span class="dot"></span>
    <span class="dot"></span>
    <span class="dot"></span>
  </div>
</div>

<div *ngIf="error()" class="error-container animate-fade-in">
  <mat-card appearance="outlined" class="error-card">
    <mat-card-content>
      <div class="error-icon-container">
        <mat-icon color="warn">error_outline</mat-icon>
      </div>
      <div class="error-message">
        <h3>{{ 'VENUES.DETAIL.ERROR_TITLE' | translate }}</h3>
        <p>{{ error() }}</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>

<div *ngIf="venue()" class="venue-details-section animate-fade-in">
  <mat-card appearance="outlined" class="venue-details-card mat-elevation-z3">
    <div class="venue-hero" [ngClass]="{'has-image': venue()?.thumbnail}">
      <div class="venue-header-content">
        <h1 class="venue-name">{{ venue()?.name }}</h1>
        <h2 class="venue-location">
          <mat-icon class="location-icon">location_on</mat-icon>
          {{ venue()?.city }}, {{ venue()?.country }}
        </h2>        <div class="venue-stats">
          <div class="stat-item">
            <mat-icon>grid_view</mat-icon>
            <div class="stat-content">
              <span class="stat-inline">{{ venue()?.sectors?.length || 0 }} {{ 'VENUES.COMMON.SECTORS' | translate }}</span>
            </div>
          </div>
          <div class="stat-item">
            <mat-icon>event_seat</mat-icon>
            <div class="stat-content">
              <span class="stat-inline">{{ venue()?.numberOfSeats | number }} {{ 'VENUES.COMMON.SEATS' | translate }}</span>
            </div>
          </div>
        </div>
      </div>
      
      <div *ngIf="venue()?.thumbnail" class="venue-image-container">
        <img class="venue-hero-image" 
             [src]="'data:' + venue()?.thumbnailContentType + ';base64,' + venue()?.thumbnail" 
             [alt]="venue()?.name + ' thumbnail'">
      </div>
      <div *ngIf="!venue()?.thumbnail" class="venue-image-placeholder">
        <mat-icon class="placeholder-icon" style="font-size: 72px; color: #bdbdbd;">image_not_supported</mat-icon>
        <p>{{ 'COMMON.NO_IMAGE' | translate }}</p>
      </div>
    </div>
    
    <mat-divider></mat-divider>
    
    <mat-card-content class="venue-details-content">
      <div class="venue-details-header-row">
        <h3 class="section-title">
          <mat-icon>info</mat-icon>
          {{ 'VENUES.DETAIL.SECTION_INFO' | translate }}
        </h3>
        <button mat-icon-button color="warn" (click)="onDelete()" class="delete-icon-btn" [disabled]="loading()" aria-label="Delete venue">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
      <div class="venue-info-grid">
        <div class="info-item">
          <div class="info-label">{{ 'VENUES.DETAIL.LABEL_ADDRESS' | translate }}</div>
          <div class="info-value">{{ getFullAddress() }}</div>
        </div>
        
        <div class="info-item full-width">
          <div class="info-label">{{ 'VENUES.DETAIL.LABEL_DESCRIPTION' | translate }}</div>
          <div class="info-value description">{{ venue()?.description || ('VENUES.DETAIL.NO_DESCRIPTION' | translate) }}</div>
        </div>
      </div>
    </mat-card-content>
    <mat-card-actions class="venue-actions" align="end">
      <button mat-stroked-button routerLink="/venues" class="back-button">
        <mat-icon>arrow_back</mat-icon>
        {{ 'BUTTON.BACK_TO_LIST' | translate }}
      </button>
      <button mat-raised-button color="primary" [routerLink]="['/venues', venue()?.venueId, 'edit']" aria-label="Edit venue" class="edit-button">
        <mat-icon>edit</mat-icon>
        {{ 'BUTTON.EDIT_VENUE' | translate }}
      </button>
    </mat-card-actions>
  </mat-card>
</div>

<!-- Venue Map Preview -->
<div *ngIf="venue()" class="venue-map-preview-section animate-fade-in">
  <mat-card appearance="outlined" class="venue-map-card mat-elevation-z3">
    <div class="participants-header-row">
      <h3 class="section-title" style="display: flex; flex-direction: column; align-items: flex-start; gap: 0;">
        <span style="display: flex; align-items: center; gap: 0.5rem;">
          <mat-icon class="title-icon">map</mat-icon>
          {{ 'VENUES.DETAIL.MAP_TITLE' | translate }}
        </span>
        <span class="banner-subtitle">{{ 'VENUES.DETAIL.MAP_SUBTITLE' | translate }}</span>
      </h3>
      <button mat-raised-button color="primary" class="edit-map-btn" [routerLink]="['/venues', venue()?.venueId, 'map-edit']" [attr.aria-label]="'VENUES.DETAIL.ARIA.EDIT_MAP' | translate">
        <mat-icon>edit</mat-icon>
        {{ 'VENUES.DETAIL.EDIT_MAP_BTN' | translate }}
      </button>
    </div>
    <mat-card-content class="map-preview-content">
      <app-venue-map-edit 
        [mode]="'preview'" 
        [venueData]="venue()">
      </app-venue-map-edit>
    </mat-card-content>
  </mat-card>
</div>
